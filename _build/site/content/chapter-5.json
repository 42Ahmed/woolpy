{"version":2,"kind":"Notebook","sha256":"c1e861b95a6ff4d21526b8d642fe5c6d741b43ac9af498e7065d3202d31db4d9","slug":"chapter-5","location":"/Chapter 5.ipynb","dependencies":[],"frontmatter":{"title":"Multiple Regression Analysis: OLS Asymptotics","content_includes_title":false,"kernelspec":{"name":"python3","display_name":"base","language":"python"},"authors":[{"id":"Ahmed H. Darwish","name":"Ahmed H. Darwish"}],"github":"https://github.com/42ahmed/woolpy","exports":[{"format":"ipynb","filename":"Chapter 5.ipynb","url":"/Chapter 5-4a222e7ea68ddcf2990083dd58ce2376.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import pandas as pd\nimport numpy as np\nimport wooldridge\nimport statsmodels.formula.api as smf\nimport matplotlib.pyplot as plt\nfrom scipy.stats import chi2","key":"rAZtbPK99S"},{"type":"output","id":"VTTuZmZ-RStd1xB08P9xB","data":[],"key":"Er3lAzkTmS"}],"key":"Q99NSO31zt"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def lm_test(data, dependent, control_vars, test_vars):\n    # Step 1: Fit restricted model\n    restricted_formula = f\"{dependent} ~ {' + '.join(control_vars)}\"\n    restricted_model = smf.ols(restricted_formula, data=data).fit()\n\n    # Step 2: Save residuals\n    data = data.copy()\n    data[\"residuals\"] = restricted_model.resid\n\n    # Step 3: Fit auxiliary regression (residuals on all vars)\n    full_vars = control_vars + test_vars\n    auxiliary_formula = f\"residuals ~ {' + '.join(full_vars)}\"\n    auxiliary_model = smf.ols(auxiliary_formula, data=data).fit()\n\n    # Step 4: Compute LM statistic and p-value\n    r_squared = auxiliary_model.rsquared\n    n = len(data)\n    q = len(test_vars)\n    lm_stat = r_squared * n\n    pval = 1 - chi2.cdf(lm_stat, df=q)\n\n    return lm_stat, pval","key":"GGNNvHPOC4"},{"type":"output","id":"197UzY8H3tkKXHvJ__bTC","data":[],"key":"o5eDpxO51r"}],"key":"Gr9TAXARb0"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Examples","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"EhgJhjvajV"}],"identifier":"examples","label":"Examples","html_id":"examples","implicit":true,"key":"Q03ZDvJGHM"}],"key":"UoUhIsMZzm"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"bwght = wooldridge.data(\"bwght\")\ncrime1 = wooldridge.data(\"crime1\")","key":"Xu5FqXATeb"},{"type":"output","id":"PmXIq7vC8M_uoRc-YX9Z8","data":[],"key":"ENYD6feULw"}],"key":"eeaVI5fLyO"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"5.1 Housing Prices and Distances From an Incinerator","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"FQnd8qzUvW"}],"identifier":"id-5-1-housing-prices-and-distances-from-an-incinerator","label":"5.1 Housing Prices and Distances From an Incinerator","html_id":"id-5-1-housing-prices-and-distances-from-an-incinerator","implicit":true,"key":"nTB2SOUGmr"}],"key":"ZjeFaFyLX5"},{"type":"block","kind":"notebook-content","children":[{"type":"math","value":"y = \\beta_0 + \\beta_1 x_1 + \\beta_2 x_2 + u","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>y</mi><mo>=</mo><msub><mi>β</mi><mn>0</mn></msub><mo>+</mo><msub><mi>β</mi><mn>1</mn></msub><msub><mi>x</mi><mn>1</mn></msub><mo>+</mo><msub><mi>β</mi><mn>2</mn></msub><msub><mi>x</mi><mn>2</mn></msub><mo>+</mo><mi>u</mi></mrow><annotation encoding=\"application/x-tex\">y = \\beta_0 + \\beta_1 x_1 + \\beta_2 x_2 + u</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05278em;\">β</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0528em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05278em;\">β</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0528em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05278em;\">β</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0528em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">u</span></span></span></span></span>","enumerator":"1","key":"fFcVZlJbWa"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"inlineMath","value":"y","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span>","key":"g8YE1k9W3H"},{"type":"text","value":": house price, ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"MwFuEwOZSG"},{"type":"inlineMath","value":"x_1","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">x_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"uM2pQ33wiK"},{"type":"text","value":": distance from incinerator, ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"kmsn2N5p8q"},{"type":"inlineMath","value":"x_2","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">x_2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"Ey2cFLKhlD"},{"type":"text","value":": quality of house","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"dyuUkLPtkI"}],"key":"tuANjOgkJ8"}],"key":"Nc8KEgrIyi"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"we expect ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"FLvdSF6deN"},{"type":"inlineMath","value":"\\beta_1 >0","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>β</mi><mn>1</mn></msub><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">\\beta_1 &gt;0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05278em;\">β</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0528em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">&gt;</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"lWEkRyiWFN"},{"type":"text","value":" and ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"SFS9Pu4zoI"},{"type":"inlineMath","value":"\\beta_2 > 0","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>β</mi><mn>2</mn></msub><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">\\beta_2 &gt; 0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05278em;\">β</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0528em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">&gt;</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"EzhojIjlNc"},{"type":"text","value":" so if ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"dRAonRNhxX"},{"type":"inlineMath","value":"x_2","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">x_2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"YulFe9LPcY"},{"type":"text","value":" is omitted and positively correlated with ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"VbUQcB9J9L"},{"type":"inlineMath","value":"x_1","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">x_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"PhsEKpnWGa"},{"type":"text","value":", OLS estimators are inconsistent","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Lo5f3CP3YV"}],"key":"ekav2Ly4LY"}],"key":"eMs9LM7X7W"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"5.2 Standard Errors in a Birth Weight Equation","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"rkL1dse8zq"}],"identifier":"id-5-2-standard-errors-in-a-birth-weight-equation","label":"5.2 Standard Errors in a Birth Weight Equation","html_id":"id-5-2-standard-errors-in-a-birth-weight-equation","implicit":true,"key":"PEOp5VElyb"}],"key":"B8SvLPmDXG"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"wooldridge.data(\"bwght\", description=True)","key":"VFcguXDmtD"},{"type":"output","id":"JEmjl-tJuKrIjKNL9OhXu","data":[{"name":"stdout","output_type":"stream","text":"name of dataset: bwght\nno of variables: 14\nno of observations: 1388\n\n+----------+--------------------------------+\n| variable | label                          |\n+----------+--------------------------------+\n| faminc   | 1988 family income, $1000s     |\n| cigtax   | cig. tax in home state, 1988   |\n| cigprice | cig. price in home state, 1988 |\n| bwght    | birth weight, ounces           |\n| fatheduc | father's yrs of educ           |\n| motheduc | mother's yrs of educ           |\n| parity   | birth order of child           |\n| male     | =1 if male child               |\n| white    | =1 if white                    |\n| cigs     | cigs smked per day while preg  |\n| lbwght   | log of bwght                   |\n| bwghtlbs | birth weight, pounds           |\n| packs    | packs smked per day while preg |\n| lfaminc  | log(faminc)                    |\n+----------+--------------------------------+\n\nJ. Mullahy (1997), “Instrumental-Variable Estimation of Count Data\nModels: Applications to Models of Cigarette Smoking Behavior,” Review\nof Economics and Statistics 79, 596-593. Professor Mullahy kindly\nprovided the data. He obtained them from the 1988 National Health\nInterview Survey.\n"}],"key":"mENQ3mHTbU"}],"key":"is2c5Mxo93"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"model02 = smf.ols(\"lbwght ~ cigs + lfaminc\", data=bwght).fit()\nmodel02.summary2().tables[1].iloc[:, :2]","key":"RBFpouGI90"},{"type":"output","id":"Wp_H0nKBx5_fMKocP-WEq","data":[{"output_type":"execute_result","execution_count":5,"metadata":{},"data":{"text/html":{"content":"<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Coef.</th>\n      <th>Std.Err.</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>Intercept</th>\n      <td>4.718594</td>\n      <td>0.018244</td>\n    </tr>\n    <tr>\n      <th>cigs</th>\n      <td>-0.004082</td>\n      <td>0.000858</td>\n    </tr>\n    <tr>\n      <th>lfaminc</th>\n      <td>0.016266</td>\n      <td>0.005583</td>\n    </tr>\n  </tbody>\n</table>\n</div>","content_type":"text/html"},"text/plain":{"content":"              Coef.  Std.Err.\nIntercept  4.718594  0.018244\ncigs      -0.004082  0.000858\nlfaminc    0.016266  0.005583","content_type":"text/plain"}}}],"key":"OsUZP8y4lA"}],"key":"DLgwb6gP2o"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"df = bwght.iloc[: len(bwght) // 2]\nmodel021 = smf.ols(\"lbwght ~ cigs + lfaminc\", data=df).fit()\nmodel021.summary2().tables[1].iloc[:, :2]","key":"WX9zPsozPi"},{"type":"output","id":"C10V-gdVCYYRC27k3-dHK","data":[{"output_type":"execute_result","execution_count":6,"metadata":{},"data":{"text/html":{"content":"<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Coef.</th>\n      <th>Std.Err.</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>Intercept</th>\n      <td>4.705583</td>\n      <td>0.027053</td>\n    </tr>\n    <tr>\n      <th>cigs</th>\n      <td>-0.004637</td>\n      <td>0.001332</td>\n    </tr>\n    <tr>\n      <th>lfaminc</th>\n      <td>0.019404</td>\n      <td>0.008188</td>\n    </tr>\n  </tbody>\n</table>\n</div>","content_type":"text/html"},"text/plain":{"content":"              Coef.  Std.Err.\nIntercept  4.705583  0.027053\ncigs      -0.004637  0.001332\nlfaminc    0.019404  0.008188","content_type":"text/plain"}}}],"key":"ky258IFsgn"}],"key":"KPyx0kmqpC"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"len(bwght), len(df)","key":"uR37Mnim1F"},{"type":"output","id":"FOQwMYeh1SwnE-rohIyqI","data":[{"output_type":"execute_result","execution_count":7,"metadata":{},"data":{"text/plain":{"content":"(1388, 694)","content_type":"text/plain"}}}],"key":"Ifxx4XahPk"}],"key":"jWg0og24zN"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Using half the dataset, the standard error for cigs is ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"CfEd8iOOC7"},{"type":"text","value":"0.0013","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"sqAnxddOi7"},{"type":"text","value":" but becomes ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ps7MMZj4RQ"},{"type":"text","value":"0.00086","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"TwYLjJWmMG"},{"type":"text","value":" if we use the whole dataset. Ratio of standard errors is ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"yd0hpniGue"},{"type":"inlineMath","value":"0.00086/ 0.0013 = 0.662","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>0.00086</mn><mi mathvariant=\"normal\">/</mi><mn>0.0013</mn><mo>=</mo><mn>0.662</mn></mrow><annotation encoding=\"application/x-tex\">0.00086/ 0.0013 = 0.662</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">0.00086/0.0013</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0.662</span></span></span></span>","key":"S2hAzHMgbJ"},{"type":"text","value":" which is equal to the approcimation ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"LoeCzEQlXs"},{"type":"inlineMath","value":"\\sqrt{694/1388} = 0.707","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msqrt><mrow><mn>694</mn><mi mathvariant=\"normal\">/</mi><mn>1388</mn></mrow></msqrt><mo>=</mo><mn>0.707</mn></mrow><annotation encoding=\"application/x-tex\">\\sqrt{694/1388} = 0.707</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.24em;vertical-align:-0.305em;\"></span><span class=\"mord sqrt\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.935em;\"><span class=\"svg-align\" style=\"top:-3.2em;\"><span class=\"pstrut\" style=\"height:3.2em;\"></span><span class=\"mord\" style=\"padding-left:1em;\"><span class=\"mord\">694/1388</span></span></span><span style=\"top:-2.895em;\"><span class=\"pstrut\" style=\"height:3.2em;\"></span><span class=\"hide-tail\" style=\"min-width:1.02em;height:1.28em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='400em' height='1.28em' viewBox='0 0 400000 1296' preserveAspectRatio='xMinYMin slice'><path d='M263,681c0.7,0,18,39.7,52,119\nc34,79.3,68.167,158.7,102.5,238c34.3,79.3,51.8,119.3,52.5,120\nc340,-704.7,510.7,-1060.3,512,-1067\nl0 -0\nc4.7,-7.3,11,-11,19,-11\nH40000v40H1012.3\ns-271.3,567,-271.3,567c-38.7,80.7,-84,175,-136,283c-52,108,-89.167,185.3,-111.5,232\nc-22.3,46.7,-33.8,70.3,-34.5,71c-4.7,4.7,-12.3,7,-23,7s-12,-1,-12,-1\ns-109,-253,-109,-253c-72.7,-168,-109.3,-252,-110,-252c-10.7,8,-22,16.7,-34,26\nc-22,17.3,-33.3,26,-34,26s-26,-26,-26,-26s76,-59,76,-59s76,-60,76,-60z\nM1001 80h400000v40h-400000z'/></svg></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.305em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0.707</span></span></span></span>","key":"kEPKeCbb0T"}],"key":"XNbOzTQ6U0"}],"key":"lpQrHXVKFl"},{"type":"block","kind":"notebook-content","children":[{"type":"math","value":"\\dfrac{SE_{new}}{SE_{old}} = \\sqrt{\\dfrac{n_{old}}{n_{new}}}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mfrac><mrow><mi>S</mi><msub><mi>E</mi><mrow><mi>n</mi><mi>e</mi><mi>w</mi></mrow></msub></mrow><mrow><mi>S</mi><msub><mi>E</mi><mrow><mi>o</mi><mi>l</mi><mi>d</mi></mrow></msub></mrow></mfrac><mo>=</mo><msqrt><mfrac><msub><mi>n</mi><mrow><mi>o</mi><mi>l</mi><mi>d</mi></mrow></msub><msub><mi>n</mi><mrow><mi>n</mi><mi>e</mi><mi>w</mi></mrow></msub></mfrac></msqrt></mrow><annotation encoding=\"application/x-tex\">\\dfrac{SE_{new}}{SE_{old}} = \\sqrt{\\dfrac{n_{old}}{n_{new}}}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.1963em;vertical-align:-0.836em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3603em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">o</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal mtight\">d</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span><span class=\"mord mathnormal mtight\">e</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02691em;\">w</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.836em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.44em;vertical-align:-0.9703em;\"></span><span class=\"mord sqrt\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.4697em;\"><span class=\"svg-align\" style=\"top:-4.4em;\"><span class=\"pstrut\" style=\"height:4.4em;\"></span><span class=\"mord\" style=\"padding-left:1em;\"><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.1076em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">n</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span><span class=\"mord mathnormal mtight\">e</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02691em;\">w</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">n</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">o</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal mtight\">d</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.836em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span><span style=\"top:-3.4297em;\"><span class=\"pstrut\" style=\"height:4.4em;\"></span><span class=\"hide-tail\" style=\"min-width:1.02em;height:2.48em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='400em' height='2.48em' viewBox='0 0 400000 2592' preserveAspectRatio='xMinYMin slice'><path d='M424,2478\nc-1.3,-0.7,-38.5,-172,-111.5,-514c-73,-342,-109.8,-513.3,-110.5,-514\nc0,-2,-10.7,14.3,-32,49c-4.7,7.3,-9.8,15.7,-15.5,25c-5.7,9.3,-9.8,16,-12.5,20\ns-5,7,-5,7c-4,-3.3,-8.3,-7.7,-13,-13s-13,-13,-13,-13s76,-122,76,-122s77,-121,77,-121\ns209,968,209,968c0,-2,84.7,-361.7,254,-1079c169.3,-717.3,254.7,-1077.7,256,-1081\nl0 -0c4,-6.7,10,-10,18,-10 H400000\nv40H1014.6\ns-87.3,378.7,-272.6,1166c-185.3,787.3,-279.3,1182.3,-282,1185\nc-2,6,-10,9,-24,9\nc-8,0,-12,-0.7,-12,-2z M1001 80\nh400000v40h-400000z'/></svg></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9703em;\"><span></span></span></span></span></span></span></span></span></span>","enumerator":"2","key":"vhDp0Y1Sw6"}],"key":"vFFHgEQy2X"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"5.3 Economic Model of Crime","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Fbtbbi0L8e"}],"identifier":"id-5-3-economic-model-of-crime","label":"5.3 Economic Model of Crime","html_id":"id-5-3-economic-model-of-crime","implicit":true,"key":"rrFPDzMne5"}],"key":"b05UlmPVVi"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"wooldridge.data(\"crime1\", description=True)","key":"HNd34FwfbW"},{"type":"output","id":"IunT3Gukwns_Wcy2dzwuT","data":[{"name":"stdout","output_type":"stream","text":"name of dataset: crime1\nno of variables: 16\nno of observations: 2725\n\n+----------+---------------------------------+\n| variable | label                           |\n+----------+---------------------------------+\n| narr86   | # times arrested, 1986          |\n| nfarr86  | # felony arrests, 1986          |\n| nparr86  | # property crme arr., 1986      |\n| pcnv     | proportion of prior convictions |\n| avgsen   | avg sentence length, mos.       |\n| tottime  | time in prison since 18 (mos.)  |\n| ptime86  | mos. in prison during 1986      |\n| qemp86   | # quarters employed, 1986       |\n| inc86    | legal income, 1986, $100s       |\n| durat    | recent unemp duration           |\n| black    | =1 if black                     |\n| hispan   | =1 if Hispanic                  |\n| born60   | =1 if born in 1960              |\n| pcnvsq   | pcnv^2                          |\n| pt86sq   | ptime86^2                       |\n| inc86sq  | inc86^2                         |\n+----------+---------------------------------+\n\nJ. Grogger (1991), “Certainty vs. Severity of Punishment,” Economic\nInquiry 29, 297-309. Professor Grogger kindly provided a subset of the\ndata he used in his article.\n"}],"key":"RbkvOfPLO5"}],"key":"GwD3rpAM56"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"model03 = smf.ols(\n    \"narr86 ~ pcnv + avgsen + tottime + ptime86 + qemp86\", data=crime1\n).fit()\nmodel03.summary2().tables[1].iloc[:, :2]","key":"zDsjFpWPrJ"},{"type":"output","id":"MR6TTNRLkobFALoiU7dZy","data":[{"output_type":"execute_result","execution_count":9,"metadata":{},"data":{"text/html":{"content":"<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Coef.</th>\n      <th>Std.Err.</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>Intercept</th>\n      <td>0.706061</td>\n      <td>0.033152</td>\n    </tr>\n    <tr>\n      <th>pcnv</th>\n      <td>-0.151225</td>\n      <td>0.040855</td>\n    </tr>\n    <tr>\n      <th>avgsen</th>\n      <td>-0.007049</td>\n      <td>0.012412</td>\n    </tr>\n    <tr>\n      <th>tottime</th>\n      <td>0.012095</td>\n      <td>0.009577</td>\n    </tr>\n    <tr>\n      <th>ptime86</th>\n      <td>-0.039259</td>\n      <td>0.008917</td>\n    </tr>\n    <tr>\n      <th>qemp86</th>\n      <td>-0.103091</td>\n      <td>0.010397</td>\n    </tr>\n  </tbody>\n</table>\n</div>","content_type":"text/html"},"text/plain":{"content":"              Coef.  Std.Err.\nIntercept  0.706061  0.033152\npcnv      -0.151225  0.040855\navgsen    -0.007049  0.012412\ntottime    0.012095  0.009577\nptime86   -0.039259  0.008917\nqemp86    -0.103091  0.010397","content_type":"text/plain"}}}],"key":"R6630bZEJy"}],"key":"TWWExtMvMg"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"To test that ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"oT9u9NpfiI"},{"type":"inlineMath","value":"avgsen, tottime","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>a</mi><mi>v</mi><mi>g</mi><mi>s</mi><mi>e</mi><mi>n</mi><mo separator=\"true\">,</mo><mi>t</mi><mi>o</mi><mi>t</mi><mi>t</mi><mi>i</mi><mi>m</mi><mi>e</mi></mrow><annotation encoding=\"application/x-tex\">avgsen, tottime</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.854em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">vg</span><span class=\"mord mathnormal\">se</span><span class=\"mord mathnormal\">n</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">tt</span><span class=\"mord mathnormal\">im</span><span class=\"mord mathnormal\">e</span></span></span></span>","key":"x8H43gsvEG"},{"type":"text","value":" have no effect using LM statistic","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jQ8p7bvewY"}],"key":"osv7UcIzhA"}],"key":"TnFmdNW93D"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"model032 = smf.ols(\"narr86 ~ pcnv  + ptime86 + qemp86\", data=crime1).fit()\nresiduals = model032.resid","key":"DCQVhqlvhk"},{"type":"output","id":"Wyks7gmCnU2D5OhS9VFfi","data":[],"key":"BZUI7T8Aww"}],"key":"cvGHDbzH50"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"df = crime1.copy()\ndf[\"residuals\"] = residuals\nmodel033 = smf.ols(\n    \"residuals ~ pcnv  + ptime86 + qemp86 + \" \"avgsen + tottime\", data=df\n).fit()\nrsquared = model033.rsquared","key":"aAjsGLHUK8"},{"type":"output","id":"cumFZCzjjEHCtnRFZxcCC","data":[],"key":"SgIlpB7jhO"}],"key":"yvtJAPX3PG"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"LM = rsquared * len(df)\nLM","key":"auTgBT9iPt"},{"type":"output","id":"Vb8SFELLII9IT53i2IzCm","data":[{"output_type":"execute_result","execution_count":12,"metadata":{},"data":{"text/plain":{"content":"np.float64(4.070729461071595)","content_type":"text/plain"}}}],"key":"mPOBgwPuSH"}],"key":"zEnpdCivrg"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The 10% critical value in a chi square distribution with 2 degrees of freedom is 4.61, so we fail to reject the null hypothesis","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"PDmbq5ETge"}],"key":"hL1BBFPCzw"}],"key":"Go0PFFgsH5"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"pval = 1 - chi2.cdf(LM, df=2)\npval","key":"gDU5hoZRa1"},{"type":"output","id":"xfY1xpbJ_y6miIhThGtYy","data":[{"output_type":"execute_result","execution_count":13,"metadata":{},"data":{"text/plain":{"content":"np.float64(0.13063282803267184)","content_type":"text/plain"}}}],"key":"Fe83VBxCTA"}],"key":"cxJf7TK9CG"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Using my function","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"TEsHhYCOH1"}],"key":"Ozb7in6Ooa"}],"key":"YvOwZws4zk"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"lm_test(\n    crime1,\n    dependent=\"narr86\",\n    control_vars=[\"pcnv\", \"ptime86\", \" qemp86\"],\n    test_vars=[\"avgsen\", \"tottime\"],\n)","key":"cJZG2yoG9r"},{"type":"output","id":"L8yp7Y8uJqj0RSX2SwhQs","data":[{"output_type":"execute_result","execution_count":14,"metadata":{},"data":{"text/plain":{"content":"(np.float64(4.070729461071595), np.float64(0.13063282803267184))","content_type":"text/plain"}}}],"key":"Sd1blrb1ud"}],"key":"LDGNeNQ0v5"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"🚧Computer Exercises","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"BymUaZMKSl"}],"identifier":"id-computer-exercises","label":"🚧Computer Exercises","html_id":"id-computer-exercises","implicit":true,"key":"dC0hCsCxiY"}],"key":"p2EM3THToJ"}],"key":"yU073IcBKP"},"references":{"cite":{"order":[],"data":{}}}}